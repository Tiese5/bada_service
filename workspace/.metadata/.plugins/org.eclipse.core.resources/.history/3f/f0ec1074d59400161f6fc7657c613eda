<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--Mammper 시작 -->
<!-- 이 파일의 경로를 config.xml에 명시해야한다 -->

<!-- Professor테이블에 대한 CRUD 기능을 구현하기 위한 Mapper -->
<mapper namespace="BbsFileMapper">
	<resultMap id="bbs_file" type="study.jsp.mysite.model.BbsFile">
		<result property="id" column="id" />
		<result property="originName" column="origin_name" />
		<result property="fileDir" column="file_dir" />
		<result property="fileName" column="file_name" />
		<result property="contentType" column="content_type" />
		<result property="fileSize" column="file_size" />
		<result property="regDate" column="reg_date" />
		<result property="editDate" column="edit_date" />
		<result property="bbsDocumentId" column="bbs_document_id"/>
	</resultMap>
	<!-- 파일 등록하기 -->
	<insert id="insertFile" parameterType="study.jsp.mysite.model.BbsFile"
			useGeneratedKeys="true" keyProperty="id">
			INSERT INTO bbs_file(
			origin_name,file_dir,file_name,content_type,
			file_size,reg_date,edit_date,bbs_document_id
			)VALUES(
			#{originName},#{fileDir},#{fileName},#{contentType},#{fileSize},
			now(),now(),#{bbsDocumentId}
			)
	</insert>
	<!-- 하나의 게시물에 속한 파일목록을 조회한다 -->
	<select id="selectfileList" parameterType="study.jsp.mysite.model.BbsFile"
	resultMap="bbs_file">
	SELECT
		id,origin_name,file_dir,file_name,
		content_type,file_size,reg_date,edit_date,bbs_document_id
		FROM bbs_file
		WHERE bbs_document_id=#{bbsDocumentId}
	</select>
	<delete id="deleteFileAll" parameterType="study.jsp.mysite.model.BbsFile">
	DELETE FROM bbs_file WHERE bbs_document_id=#{bbsDocumentId}
	</delete>
	<!-- 하나의 파일을 조회한다 -->
	<select id="selectfile" parameterType="study.jsp.mysite.model.BbsFile"
	resultMap="bbs_file">
		SELECT file_dir, file_name FROM bbs_file WHERE id=#{id}
	</select>
</mapper>

